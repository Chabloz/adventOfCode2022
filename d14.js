//testing other input
const input = `493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101\n490,34 -> 494,34\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n493,32 -> 497,32\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n458,132 -> 463,132\n473,38 -> 487,38\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n482,76 -> 486,76\n451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138\n455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51\n490,26 -> 494,26\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138\n469,171 -> 473,171\n469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101\n487,32 -> 491,32\n472,168 -> 476,168\n496,30 -> 500,30\n455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114\n459,151 -> 459,152 -> 468,152 -> 468,151\n451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138\n459,151 -> 459,152 -> 468,152 -> 468,151\n496,34 -> 500,34\n484,30 -> 488,30\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n451,132 -> 456,132\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n490,30 -> 494,30\n455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n461,129 -> 466,129\n472,72 -> 472,73 -> 483,73 -> 483,72\n481,32 -> 485,32\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n476,82 -> 480,82\n454,129 -> 459,129\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88\n465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n488,82 -> 492,82\n487,28 -> 491,28\n470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n473,54 -> 481,54 -> 481,53\n485,79 -> 489,79\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n479,85 -> 483,85\n463,177 -> 467,177\n455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n462,135 -> 467,135\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88\n472,174 -> 476,174\n469,135 -> 474,135\n478,34 -> 482,34\n479,79 -> 483,79\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n465,132 -> 470,132\n470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138\n448,135 -> 453,135\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n482,82 -> 486,82\n465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101\n484,34 -> 488,34\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n473,54 -> 481,54 -> 481,53\n469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n457,126 -> 462,126\n475,177 -> 479,177\n455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138\n478,174 -> 482,174\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n472,72 -> 472,73 -> 483,73 -> 483,72\n469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n499,32 -> 503,32\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n481,177 -> 485,177\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n455,135 -> 460,135\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n472,72 -> 472,73 -> 483,73 -> 483,72\n463,67 -> 463,57 -> 463,67 -> 465,67 -> 465,64 -> 465,67 -> 467,67 -> 467,64 -> 467,67 -> 469,67 -> 469,57 -> 469,67 -> 471,67 -> 471,62 -> 471,67 -> 473,67 -> 473,57 -> 473,67 -> 475,67 -> 475,65 -> 475,67 -> 477,67 -> 477,57 -> 477,67 -> 479,67 -> 479,58 -> 479,67\n470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88\n502,34 -> 506,34\n465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101\n451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138\n469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51\n485,85 -> 489,85\n475,171 -> 479,171\n459,151 -> 459,152 -> 468,152 -> 468,151\n491,85 -> 495,85\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n469,51 -> 469,42 -> 469,51 -> 471,51 -> 471,42 -> 471,51 -> 473,51 -> 473,43 -> 473,51\n463,165 -> 463,160 -> 463,165 -> 465,165 -> 465,156 -> 465,165 -> 467,165 -> 467,159 -> 467,165 -> 469,165 -> 469,157 -> 469,165 -> 471,165 -> 471,163 -> 471,165 -> 473,165 -> 473,156 -> 473,165\n465,101 -> 465,103 -> 458,103 -> 458,111 -> 477,111 -> 477,103 -> 469,103 -> 469,101\n470,88 -> 470,92 -> 469,92 -> 469,98 -> 483,98 -> 483,92 -> 475,92 -> 475,88\n493,28 -> 497,28\n473,85 -> 477,85\n493,23 -> 493,20 -> 493,23 -> 495,23 -> 495,22 -> 495,23 -> 497,23 -> 497,13 -> 497,23 -> 499,23 -> 499,21 -> 499,23 -> 501,23 -> 501,20 -> 501,23 -> 503,23 -> 503,13 -> 503,23 -> 505,23 -> 505,16 -> 505,23\n455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114\n455,114 -> 455,118 -> 451,118 -> 451,123 -> 459,123 -> 459,118 -> 458,118 -> 458,114\n469,177 -> 473,177\n451,138 -> 451,141 -> 444,141 -> 444,147 -> 463,147 -> 463,141 -> 455,141 -> 455,138\n466,174 -> 470,174`;

const rock = Symbol('rock');
const air = Symbol('air');
const sand = Symbol('sand');
const sandSpawn = {row: 0, col: 500};

function parseInput(input) {
  const paths = input.split('\n')
      .map(path => path
        .split(' -> ')
        .map(coords => coords.split(','))
        .map(coords => ({row: Number(coords[1]), col: Number(coords[0])}))
      );

  // Normalize to make the grid start at 0,0
  const colCoords = paths.flat(1).map(path => path.col);
  const rowCoords = paths.flat(1).map(path => path.row);
  const minCol = Math.min(...colCoords);
  const maxCol = Math.max(...colCoords);
  sandSpawn.col -=  minCol;
  const minRow = sandSpawn.row;
  const maxRow = Math.max(...rowCoords);
  const nbCols = maxCol - minCol + 1;
  const nbRows = maxRow - minRow + 1;

  const grid = Array.from({length: nbRows}, () => Array(nbCols).fill(air));

  for (const path of paths) {
    for (let i = 1; i < path.length; i++) {
      const previous = path[i - 1];
      const current = path[i];
      const startCol = Math.min(current.col, previous.col) - minCol;
      const endCol = Math.max(current.col, previous.col) - minCol;
      const startRow = Math.min(current.row, previous.row) - minRow;
      const endRow = Math.max(current.row, previous.row) - minRow;
      for (let col = startCol; col <= endCol; col++) {
        for (let row = startRow; row <= endRow; row++) {
          grid[row][col] = rock;
        }
      }
    }
  }

  return grid;
}

function dropSand(grid, sandSpawn) {
  let col = sandSpawn.col;
  let row = sandSpawn.row;
  while (row < grid.length) {
    // if it goes out of bounds, the solution is found
    if (grid[row + 1] === undefined || grid[row + 1][col - 1] === undefined || grid[row + 1][col + 1] === undefined) {
      return false;
    }
    if (grid[row + 1][col] === air) {
      row++;
    } else if (grid[row + 1][col - 1] === air) {
      row++;
      col--;
    } else if (grid[row + 1][col + 1] === air) {
      row++;
      col++;
    } else {
      break;
    }
  }
  grid[row][col] = sand;
  return true;
}

const grid = parseInput(input);

// part 1
let nbGrainsOfSand = 0;
while (dropSand(grid, sandSpawn)) nbGrainsOfSand++;
console.log(nbGrainsOfSand);

// part 2
// Padd the grid with air cells
const padding = 250;
sandSpawn.col += padding;
const airPadding = Array(padding).fill(air);
for (const [rowInd, row] of grid.entries()) {
  grid[rowInd] = [...airPadding, ...row, ...airPadding];
}

// Add the two new rows
grid.push(Array(grid[0].length).fill(air));
grid.push(Array(grid[0].length).fill(rock));

while (grid[sandSpawn.row][sandSpawn.col] != sand) {
  dropSand(grid, sandSpawn);
  nbGrainsOfSand++;
}

console.log(nbGrainsOfSand);
